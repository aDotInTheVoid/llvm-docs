<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLVM: lib/Target/X86/X86LowerAMXType.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">LLVM
   &#160;<span id="projectnumber">13.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_794e483eb1cc7921d35fd149d9cc325b.html">Target</a></li><li class="navelem"><a class="el" href="dir_558b7c0c66e2ff4834e628dd4b3edd32.html">X86</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">X86LowerAMXType.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="X86LowerAMXType_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//===- Target/X86/X86LowerAMXType.cpp - -------------------------*- C++ -*-===//</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// See https://llvm.org/LICENSE.txt for license information.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span><span class="comment"></span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/// \file Pass to transform &lt;256 x i32&gt; load/store</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">/// &lt;256 x i32&gt; is bitcasted to x86_amx on X86, and AMX instruction set only</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">/// provides simple operation on x86_amx. The basic elementwise operation</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">/// is not supported by AMX. Since x86_amx is bitcasted from vector &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">/// and only AMX intrinsics can operate on the type, we need transform</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">/// load/store &lt;256 x i32&gt; instruction to AMX load/store. If the bitcast can</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/// not be combined with load/store, we transform the bitcast to amx load/store</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">/// and &lt;256 x i32&gt; store/load.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">///</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">/// If Front End not use O0 but the Mid/Back end use O0, (e.g. &quot;Clang -O2 -S</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">/// -emit-llvm t.c&quot; + &quot;llc t.ll&quot;) we should make sure the amx data is volatile,</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/// because that is necessary for AMX fast register allocation. (In Fast</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/// registera allocation, register will be allocated before spill/reload, so</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/// there is no additional register for amx to identify the step in spill.)</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">/// The volatileTileData() will handle this case.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">/// e.g.</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/// ----------------------------------------------------------</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/// | def %td = ...                                          |</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/// | ...                                                    |</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">/// | &quot;use %td&quot;                                              |</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">/// ----------------------------------------------------------</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">/// will transfer to --&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">/// ----------------------------------------------------------</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">/// | def %td = ...                                          |</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">/// | call void @llvm.x86.tilestored64.internal(mem, %td)    |</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/// | ...                                                    |</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/// | %td2 = call x86_amx @llvm.x86.tileloadd64.internal(mem)|</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">/// | &quot;use %td2&quot;                                             |</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">/// ----------------------------------------------------------</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span><span class="comment">//</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//===----------------------------------------------------------------------===//</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="X86_8h.html">X86.h</a>&quot;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PostOrderIterator_8h.html">llvm/ADT/PostOrderIterator.h</a>&quot;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="SmallSet_8h.html">llvm/ADT/SmallSet.h</a>&quot;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="OptimizationRemarkEmitter_8h.html">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetTransformInfo_8h.html">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="CodeGen_2Passes_8h.html">llvm/CodeGen/Passes.h</a>&quot;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="TargetPassConfig_8h.html">llvm/CodeGen/TargetPassConfig.h</a>&quot;</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ValueTypes_8h.html">llvm/CodeGen/ValueTypes.h</a>&quot;</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataLayout_8h.html">llvm/IR/DataLayout.h</a>&quot;</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Function_8h.html">llvm/IR/Function.h</a>&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IRBuilder_8h.html">llvm/IR/IRBuilder.h</a>&quot;</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Instructions_8h.html">llvm/IR/Instructions.h</a>&quot;</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="IntrinsicInst_8h.html">llvm/IR/IntrinsicInst.h</a>&quot;</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;llvm/IR/IntrinsicsX86.h&quot;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="PatternMatch_8h.html">llvm/IR/PatternMatch.h</a>&quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="InitializePasses_8h.html">llvm/InitializePasses.h</a>&quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Pass_8h.html">llvm/Pass.h</a>&quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="llvm_2Target_2TargetMachine_8h.html">llvm/Target/TargetMachine.h</a>&quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacellvm.html">llvm</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="keyword">using namespace </span>PatternMatch;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">   63</a></span>&#160;<span class="preprocessor">#define DEBUG_TYPE &quot;lower-amx-type&quot;</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#aa1e4852319a4ba1d0d006fd04fa95c9f">   65</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *<a class="code" href="X86LowerAMXType_8cpp.html#aa1e4852319a4ba1d0d006fd04fa95c9f">createAllocaInstAtEntry</a>(<a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> &amp;<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                                           <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getParent();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getModule();</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDataLayout();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *V256I32Ty = <a class="code" href="classllvm_1_1VectorType.html#a8c90e6c50e795b17466482a04947690e">VectorType::get</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32Ty(), 256, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classllvm_1_1LLVMContext.html">LLVMContext</a> &amp;Ctx = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getContext();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keyword">auto</span> AllocaAlignment = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPrefTypeAlign(<a class="code" href="classllvm_1_1Type.html#a08ceb864464bce07aed4387d665f6565">Type::getX86_AMXTy</a>(Ctx));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">unsigned</span> AllocaAS = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getAllocaAddrSpace();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AllocaRes =</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      <span class="keyword">new</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>(V256I32Ty, AllocaAS, <span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getEntryBlock().front());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  AllocaRes-&gt;<a class="code" href="classllvm_1_1AllocaInst.html#af3bb24b322533dbe8a63c84b18568fe1">setAlignment</a>(AllocaAlignment);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="keywordflow">return</span> AllocaRes;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;}</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="keyword">class </span>X86LowerAMXType {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Func;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// In AMX intrinsics we let Shape = {Row, Col}, but the</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// RealCol = Col / ElementSize. We may use the RealCol</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="comment">// as a new Row for other new created AMX intrinsics.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  std::map&lt;Value *, Value *&gt; Col2Row;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  X86LowerAMXType(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *TargetM) : Func(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>), <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>(TargetM) {}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordtype">bool</span> visit();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="keywordtype">void</span> combineLoadBitcast(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>, <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keywordtype">void</span> combineBitcastStore(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="keywordtype">bool</span> transformBitcast(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  std::pair&lt;Value *, Value *&gt; getShape(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II, <span class="keywordtype">unsigned</span> OpNo);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *getRowFromCol(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *II, <a class="code" href="classllvm_1_1Value.html">Value</a> *V, <span class="keywordtype">unsigned</span> Granularity);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;};</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *X86LowerAMXType::getRowFromCol(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *II, <a class="code" href="classllvm_1_1Value.html">Value</a> *V,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                                      <span class="keywordtype">unsigned</span> Granularity) {</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">if</span> (Col2Row.count(V))</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">return</span> Col2Row[V];</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(&amp;*II-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>()-&gt;<a class="code" href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = dyn_cast&lt;Instruction&gt;(V)) {</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> Iter = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator();</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    ++Iter;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;*Iter);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  }</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="classllvm_1_1ConstantInt.html">ConstantInt</a> *Gran = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt16(Granularity);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *RealRow = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateUDiv(V, Gran);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  Col2Row[V] = RealRow;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordflow">return</span> RealRow;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;std::pair&lt;Value *, Value *&gt; X86LowerAMXType::getShape(<a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                                      <span class="keywordtype">unsigned</span> OpNo) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = <span class="keyword">nullptr</span>, *Col = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <span class="keywordflow">switch</span> (II-&gt;<a class="code" href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">getIntrinsicID</a>()) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <a class="code" href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a>(<span class="stringliteral">&quot;Expect amx intrinsics&quot;</span>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tileloadd64_internal:</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tileloaddt164_internal:</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tilestored64_internal: {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    Row = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    Col = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="comment">// a * b + c</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="comment">// The shape depends on which operand.</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tdpbssd_internal:</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tdpbsud_internal:</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tdpbusd_internal:</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tdpbuud_internal:</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">case</span> Intrinsic::x86_tdpbf16ps_internal: {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">switch</span> (OpNo) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      Row = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      Col = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;      Row = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(0);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      Col = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      Row = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(2);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="comment">// FIXME: There is a design bug for AMX shape, which the Col should be</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="comment">// Col/4 if it will be used as Row, but current Greedy RA can&#39;t handle</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <span class="comment">// this case well, it may failed if we generate a new Shape definition.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;      <span class="comment">// So Let&#39;s just do it in O0 first.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      <span class="comment">// Row = Row / 4</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>-&gt;getOptLevel() == <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928">CodeGenOpt::None</a>)</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        Row = getRowFromCol(II, Row, 4);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      Col = II-&gt;<a class="code" href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">getArgOperand</a>(1);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keywordflow">return</span> std::make_pair(Row, Col);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">// %src = load &lt;256 x i32&gt;, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">// %2 = bitcast &lt;256 x i32&gt; %src to x86_amx</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">// %2 = call x86_amx @llvm.x86.tileloadd64.internal(i16 %row, i16 %col,</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">// i8* %addr, i64 %stride64)</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="keywordtype">void</span> X86LowerAMXType::combineLoadBitcast(<a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>, <a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>) {</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = <span class="keyword">nullptr</span>, *Col = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U = *(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;use_begin());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keywordtype">unsigned</span> OpNo = U.<a class="code" href="classllvm_1_1Use.html#a541187eb976df2189b40b3f62ed2cee0">getOperandNo</a>();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keyword">auto</span> *II = cast&lt;IntrinsicInst&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>());</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  std::tie(Row, Col) = getShape(II, OpNo);</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// Use the maximun column as stride.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Stride = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(64);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *I8Ptr =</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>-&gt;getOperand(0), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy());</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  std::array&lt;Value *, 4&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a> = {Row, Col, I8Ptr, Stride};</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInst =</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::x86_tileloadd64_internal, None, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;replaceAllUsesWith(NewInst);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;}</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">// %src = call x86_amx @llvm.x86.tileloadd64.internal(%row, %col, %addr,</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">//                                                    %stride);</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">// %13 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">// store &lt;256 x i32&gt; %13, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">// call void @llvm.x86.tilestored64.internal(%row, %col, %addr,</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">//                                           %stride64, %13)</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keywordtype">void</span> X86LowerAMXType::combineBitcastStore(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>, <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Tile = <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">auto</span> *II = cast&lt;IntrinsicInst&gt;(Tile);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// Tile is output from AMX intrinsic. The first operand of the</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="comment">// intrinsic is row, the second operand of the intrinsic is column.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Col = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <span class="comment">// Use the maximum column as stride. It must be the same with load</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// stride.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Stride = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(64);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *I8Ptr =</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>-&gt;getOperand(1), <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy());</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  std::array&lt;Value *, 5&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a> = {Row, Col, I8Ptr, Stride, Tile};</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::x86_tilestored64_internal, None, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;hasOneUse())</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">// %13 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="comment">// store &lt;256 x i32&gt; %13, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">// %add = &lt;256 x i32&gt; %13, &lt;256 x i32&gt; %src2</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">// %13 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="comment">// call void @llvm.x86.tilestored64.internal(%row, %col, %addr,</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//                                           %stride64, %13)</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">// %14 = load &lt;256 x i32&gt;, %addr</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="comment">// %add = &lt;256 x i32&gt; %14, &lt;256 x i32&gt; %src2</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Vec = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getType(), <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>-&gt;getOperand(1));</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;replaceAllUsesWith(Vec);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;}</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">// transform bitcast to &lt;store, load&gt; instructions.</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="keywordtype">bool</span> X86LowerAMXType::transformBitcast(<a class="code" href="classllvm_1_1BitCastInst.html">BitCastInst</a> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AllocaAddr;</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *I8Ptr, *Stride;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keyword">auto</span> *Src = <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keyword">auto</span> Prepare = [&amp;]() {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    AllocaAddr = <a class="code" href="X86LowerAMXType_8cpp.html#aa1e4852319a4ba1d0d006fd04fa95c9f">createAllocaInstAtEntry</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>, <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getParent());</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    I8Ptr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(AllocaAddr, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy());</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    Stride = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(64);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  };</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getType()-&gt;isX86_AMXTy()) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="comment">// %2 = bitcast &lt;256 x i32&gt; %src to x86_amx</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// %addr = alloca &lt;256 x i32&gt;, align 64</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// store &lt;256 x i32&gt; %src, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">// %addr2 = bitcast &lt;256 x i32&gt;* to i8*</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// %2 = call x86_amx @llvm.x86.tileloadd64.internal(i16 %row, i16 %col,</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">//                                                  i8* %addr2,</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="comment">//                                                  i64 64)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U = *(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;use_begin());</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordtype">unsigned</span> OpNo = U.<a class="code" href="classllvm_1_1Use.html#a541187eb976df2189b40b3f62ed2cee0">getOperandNo</a>();</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <span class="keywordflow">if</span> (!II)</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// May be bitcast from x86amx to &lt;256 x i32&gt;.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    Prepare();</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateStore(Src, AllocaAddr);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="comment">// TODO we can pick an constant operand for the shape.</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = <span class="keyword">nullptr</span>, *Col = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    std::tie(Row, Col) = getShape(II, OpNo);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    std::array&lt;Value *, 4&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a> = {Row, Col, I8Ptr, Stride};</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInst = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        Intrinsic::x86_tileloadd64_internal, None, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;replaceAllUsesWith(NewInst);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// %2 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="comment">// %addr = alloca &lt;256 x i32&gt;, align 64</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// %addr2 = bitcast &lt;256 x i32&gt;* to i8*</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="comment">// call void @llvm.x86.tilestored64.internal(i16 %row, i16 %col,</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="comment">//                                           i8* %addr2, i64 %stride)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">// %2 = load &lt;256 x i32&gt;, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keyword">auto</span> *II = dyn_cast&lt;IntrinsicInst&gt;(Src);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">if</span> (!II)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// May be bitcast from &lt;256 x i32&gt; to x86amx.</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    Prepare();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *Col = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    std::array&lt;Value *, 5&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a> = {Row, Col, I8Ptr, Stride, Src};</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::x86_tilestored64_internal, None, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *NewInst = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateLoad(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getType(), AllocaAddr);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;replaceAllUsesWith(NewInst);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keywordtype">bool</span> X86LowerAMXType::visit() {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> DeadInsts;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  Col2Row.<a class="code" href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="namespacellvm.html#aa0953557ed13c0ed48e740653e07c979">post_order</a>(&amp;Func)) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html#a6d3231fb84ed4182ec22e9442a87dbf8">BasicBlock::reverse_iterator</a> II = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;rbegin(), <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;rend();</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;         II != <a class="code" href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">IE</a>;) {</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;Inst = *II++;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keyword">auto</span> *<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a> = dyn_cast&lt;BitCastInst&gt;(&amp;Inst);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <a class="code" href="classllvm_1_1Value.html">Value</a> *Src = <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getOperand(0);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;getType()-&gt;isX86_AMXTy()) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;user_empty()) {</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;          DeadInsts.push_back(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        }</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <a class="code" href="classllvm_1_1LoadInst.html">LoadInst</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a> = dyn_cast&lt;LoadInst&gt;(Src);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;          <span class="keywordflow">if</span> (transformBitcast(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>))</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            DeadInsts.push_back(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment">// If load has mutli-user, duplicate a vector load.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        <span class="comment">// %src = load &lt;256 x i32&gt;, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="comment">// %2 = bitcast &lt;256 x i32&gt; %src to x86_amx</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="comment">// %add = add &lt;256 x i32&gt; %src, &lt;256 x i32&gt; %src2</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="comment">// %src = load &lt;256 x i32&gt;, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        <span class="comment">// %2 = call x86_amx @llvm.x86.tileloadd64.internal(i16 %row, i16 %col,</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        <span class="comment">//                                            i8* %addr, i64 %stride64)</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="comment">// %add = add &lt;256 x i32&gt; %src, &lt;256 x i32&gt; %src2</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// If load has one user, the load will be eliminated in DAG ISel.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="comment">// %src = load &lt;256 x i32&gt;, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="comment">// %2 = bitcast &lt;256 x i32&gt; %src to x86_amx</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="comment">// %2 = call x86_amx @llvm.x86.tileloadd64.internal(i16 %row, i16 %col,</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">//                                            i8* %addr, i64 %stride64)</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        combineLoadBitcast(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>, <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        DeadInsts.push_back(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>-&gt;hasOneUse())</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;          DeadInsts.push_back(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">LD</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Src-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ab549082d9dfb91ec9a8dc06601d54855">isX86_AMXTy</a>()) {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;user_empty()) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;          DeadInsts.push_back(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <a class="code" href="classllvm_1_1StoreInst.html">StoreInst</a> *<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> UI = <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;use_begin(), UE = <a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>-&gt;use_end();</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;             UI != UE;) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = (UI++)-&gt;getUser();</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> = dyn_cast&lt;StoreInst&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>) {</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;          <span class="keywordflow">if</span> (transformBitcast(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>))</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            DeadInsts.push_back(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        <span class="comment">// If bitcast (%13) has one use, combine bitcast and store to amx store.</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="comment">// %src = call x86_amx @llvm.x86.tileloadd64.internal(%row, %col, %addr,</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">//                                                    %stride);</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="comment">// %13 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="comment">// store &lt;256 x i32&gt; %13, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment">// call void @llvm.x86.tilestored64.internal(%row, %col, %addr,</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="comment">//                                           %stride64, %13)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment">// If bitcast (%13) has multi-use, transform as below.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment">// %13 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="comment">// store &lt;256 x i32&gt; %13, &lt;256 x i32&gt;* %addr, align 64</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// %add = &lt;256 x i32&gt; %13, &lt;256 x i32&gt; %src2</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="comment">// %13 = bitcast x86_amx %src to &lt;256 x i32&gt;</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// call void @llvm.x86.tilestored64.internal(%row, %col, %addr,</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        <span class="comment">//                                           %stride64, %13)</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment">// %14 = load &lt;256 x i32&gt;, %addr</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <span class="comment">// %add = &lt;256 x i32&gt; %14, &lt;256 x i32&gt; %src2</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        combineBitcastStore(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>, <a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="comment">// Delete user first.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        DeadInsts.push_back(<a class="code" href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a>);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        DeadInsts.push_back(<a class="code" href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">Bitcast</a>);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = !DeadInsts.empty();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *Inst : DeadInsts)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    Inst-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;}</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#a037d32dd369344ad942d161c3c2681a9">  384</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="X86LowerAMXType_8cpp.html#a037d32dd369344ad942d161c3c2681a9">getAllocaPos</a>(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="classllvm_1_1Module.html">Module</a> *<a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getModule();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> *<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>-&gt;getParent();</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(&amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock().front());</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="keyword">const</span> <a class="code" href="classllvm_1_1DataLayout.html">DataLayout</a> &amp;<a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a class="code" href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a>-&gt;getDataLayout();</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  <span class="keywordtype">unsigned</span> AllocaAS = <a class="code" href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getAllocaAddrSpace();</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <a class="code" href="classllvm_1_1Type.html">Type</a> *V256I32Ty = <a class="code" href="classllvm_1_1VectorType.html#a8c90e6c50e795b17466482a04947690e">VectorType::get</a>(<a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt32Ty(), 256, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a> *AllocaRes =</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      <span class="keyword">new</span> <a class="code" href="classllvm_1_1AllocaInst.html">AllocaInst</a>(V256I32Ty, AllocaAS, <span class="stringliteral">&quot;&quot;</span>, &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock().front());</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> Iter = AllocaRes-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>();</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  ++Iter;</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.SetInsertPoint(&amp;*Iter);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *I8Ptr = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateBitCast(AllocaRes, <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt8PtrTy());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">return</span> I8Ptr;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#abef33f2e31a1adf2ae4318a9b14b37fc">  400</a></span>&#160;<span class="keyword">static</span> <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="X86LowerAMXType_8cpp.html#abef33f2e31a1adf2ae4318a9b14b37fc">createTileStore</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TileDef, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TileDef-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ab549082d9dfb91ec9a8dc06601d54855">isX86_AMXTy</a>() &amp;&amp; <span class="stringliteral">&quot;Not define tile!&quot;</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keyword">auto</span> *II = cast&lt;IntrinsicInst&gt;(TileDef);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(II &amp;&amp; <span class="stringliteral">&quot;Not tile intrinsic!&quot;</span>);</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Col = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = TileDef-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> Iter = TileDef-&gt;<a class="code" href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">getIterator</a>();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, ++Iter);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Stride = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(64);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  std::array&lt;Value *, 5&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a> = {Row, Col, Ptr, Stride, TileDef};</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *TileStore =</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::x86_tilestored64_internal, <a class="code" href="namespacellvm.html#a6497a581a4f7152729c29a368ac7d7be">None</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordflow">return</span> TileStore;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#a20c7ea50a73d61a91772d1c57f2baade">  418</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="X86LowerAMXType_8cpp.html#a20c7ea50a73d61a91772d1c57f2baade">replaceWithTileLoad</a>(<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U, <a class="code" href="classllvm_1_1Value.html">Value</a> *Ptr, <span class="keywordtype">bool</span> IsPHI = <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *V = U.<a class="code" href="classllvm_1_1Use.html#a04219443419738082ae3a5fd4f8e4489">get</a>();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V-&gt;<a class="code" href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">getType</a>()-&gt;<a class="code" href="classllvm_1_1Type.html#ab549082d9dfb91ec9a8dc06601d54855">isX86_AMXTy</a>() &amp;&amp; <span class="stringliteral">&quot;Not define tile!&quot;</span>);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;  <span class="comment">// Get tile shape.</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <a class="code" href="classllvm_1_1IntrinsicInst.html">IntrinsicInst</a> *II = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">if</span> (IsPHI) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *PhiOp = dyn_cast&lt;PHINode&gt;(V)-&gt;getIncomingValue(0);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    II = cast&lt;IntrinsicInst&gt;(PhiOp);</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    II = cast&lt;IntrinsicInst&gt;(V);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;  }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Row = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(0);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Col = II-&gt;<a class="code" href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">getOperand</a>(1);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *UserI = dyn_cast&lt;Instruction&gt;(U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>());</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="classllvm_1_1IRBuilder.html">IRBuilder&lt;&gt;</a> <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>(UserI);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *Stride = <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.getInt64(64);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  std::array&lt;Value *, 4&gt; <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a> = {Row, Col, Ptr, Stride};</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *TileLoad =</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <a class="code" href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a>.CreateIntrinsic(Intrinsic::x86_tileloadd64_internal, <a class="code" href="namespacellvm.html#a6497a581a4f7152729c29a368ac7d7be">None</a>, <a class="code" href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">Args</a>);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;  UserI-&gt;<a class="code" href="classllvm_1_1User.html#a1f0b9358936e3e00c42a460abbfb2868">replaceUsesOfWith</a>(V, TileLoad);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;}</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#acf41daf3eeda8514648fe10fbd699be7">  443</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="X86LowerAMXType_8cpp.html#acf41daf3eeda8514648fe10fbd699be7">isIncomingOfPHI</a>(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;uses()) {</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a> *V = U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>();</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(V))</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;}</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">// Let all AMX tile data become volatile data, shorten the life range</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">// of each tile register before fast register allocation.</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="keyword">class </span>X86VolatileTileData {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  X86VolatileTileData(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;Func) : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>(Func) {}</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *updatePhiIncomings(<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>,</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                            <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 2&gt;</a> &amp;Incomings);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keywordtype">void</span> replacePhiDefWithLoad(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PHI, <a class="code" href="classllvm_1_1Value.html">Value</a> *StorePtr);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  <span class="keywordtype">bool</span> volatileTileData();</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  <span class="keywordtype">void</span> volatileTilePHI(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *Inst);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keywordtype">void</span> volatileTileNonPHI(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;};</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<a class="code" href="classllvm_1_1Value.html">Value</a> *X86VolatileTileData::updatePhiIncomings(</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 2&gt;</a> &amp;Incomings) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *I8Ptr = <a class="code" href="X86LowerAMXType_8cpp.html#a037d32dd369344ad942d161c3c2681a9">getAllocaPos</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : Incomings) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a> *<a class="code" href="namespacellvm_1_1SPII.html#a2ab8a310a4181c487902735f4758ca88a36b3dd3b84fde3f8494a9b18af131856">Store</a> = <a class="code" href="X86LowerAMXType_8cpp.html#abef33f2e31a1adf2ae4318a9b14b37fc">createTileStore</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, I8Ptr);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">// All its uses (except phi) should load from stored mem.</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;uses()) {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <a class="code" href="classllvm_1_1User.html">User</a> *V = U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(V) || V == <a class="code" href="namespacellvm_1_1SPII.html#a2ab8a310a4181c487902735f4758ca88a36b3dd3b84fde3f8494a9b18af131856">Store</a>)</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <a class="code" href="X86LowerAMXType_8cpp.html#a20c7ea50a73d61a91772d1c57f2baade">replaceWithTileLoad</a>(U, I8Ptr);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  <span class="keywordflow">return</span> I8Ptr;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;}</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="keywordtype">void</span> X86VolatileTileData::replacePhiDefWithLoad(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *PHI,</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                                <a class="code" href="classllvm_1_1Value.html">Value</a> *StorePtr) {</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : PHI-&gt;<a class="code" href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">uses</a>())</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="X86LowerAMXType_8cpp.html#a20c7ea50a73d61a91772d1c57f2baade">replaceWithTileLoad</a>(U, StorePtr, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  PHI-&gt;<a class="code" href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">eraseFromParent</a>();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">// Smilar with volatileTileNonPHI, this function only handle PHI Nodes</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">// and their related AMX intrinsics.</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">// 1) PHI Def should change to tileload.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">// 2) PHI Incoming Values should tilestored in just after their def.</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">// 3) The mem of these tileload and tilestores should be same.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">// e.g.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">// bb_dom:</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">//   br i1 %bool.cond, label %if.else, label %if.then</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">// if.then:</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">//   def %t0 = ...</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">//   use %t0</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">//   br label %if.end</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">// if.else:</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">//   def %t1 = ...</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">//   br label %if.end</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">// if.end:</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">//   %td = phi x86_amx [ %t1, %if.else ], [ %t0, %if.then ]</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">//   use %td</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">// bb_entry:</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">//   %mem = alloca &lt;256 x i32&gt;, align 1024                  *</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">// bb_dom:</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">//   br i1 %bool.cond, label %if.else, label %if.then</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">// if.then:</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">//   def %t0 = ...</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">//   call void @llvm.x86.tilestored64.internal(mem, %t0)    *</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">//   %t0` = call x86_amx @llvm.x86.tileloadd64.internal(mem)*</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">//   use %t0`                                               *</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">//   br label %if.end</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">// if.else:</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">//   def %t1 = ...</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">//   call void @llvm.x86.tilestored64.internal(mem, %t1)    *</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">//   br label %if.end</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">// if.end:</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">//   ...</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">//   %td = call x86_amx @llvm.x86.tileloadd64.internal(mem) *</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">//   use %td</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="keywordtype">void</span> X86VolatileTileData::volatileTilePHI(<a class="code" href="classllvm_1_1PHINode.html">PHINode</a> *PHI) {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = PHI-&gt;<a class="code" href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">getParent</a>();</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 2&gt;</a> Incomings;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a> = PHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a class="code" href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a>; ++<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="classllvm_1_1Value.html">Value</a> *<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a> = PHI-&gt;<a class="code" href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">getIncomingValue</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *Inst = dyn_cast&lt;Instruction&gt;(<a class="code" href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">Op</a>);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Inst &amp;&amp; <span class="stringliteral">&quot;We shouldn&#39;t fold AMX instrution!&quot;</span>);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    Incomings.push_back(Inst);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; </div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *StorePtr = updatePhiIncomings(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>, Incomings);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  replacePhiDefWithLoad(PHI, StorePtr);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">// Store the defined tile and load it before use.</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">// All its users are not PHI.</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">// e.g.</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">// def %td = ...</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">// ...</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">// &quot;use %td&quot;</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">// --&gt;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">// def %td = ...</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">// call void @llvm.x86.tilestored64.internal(mem, %td)</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">// ...</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">// %td2 = call x86_amx @llvm.x86.tileloadd64.internal(mem)</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">// &quot;use %td2&quot;</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">// ------------------------------------------------------</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="keywordtype">void</span> X86VolatileTileData::volatileTileNonPHI(<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  <a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> *<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> = <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  <a class="code" href="classllvm_1_1Value.html">Value</a> *I8Ptr = <a class="code" href="X86LowerAMXType_8cpp.html#a037d32dd369344ad942d161c3c2681a9">getAllocaPos</a>(<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;  <a class="code" href="classllvm_1_1User.html">User</a> *<a class="code" href="namespacellvm_1_1SPII.html#a2ab8a310a4181c487902735f4758ca88a36b3dd3b84fde3f8494a9b18af131856">Store</a> = <a class="code" href="X86LowerAMXType_8cpp.html#abef33f2e31a1adf2ae4318a9b14b37fc">createTileStore</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>, I8Ptr);</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;  <span class="comment">// All its uses should load from stored mem.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Use.html">Use</a> &amp;U : <a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;uses()) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="classllvm_1_1User.html">User</a> *V = U.<a class="code" href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">getUser</a>();</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    <a class="code" href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!isa&lt;PHINode&gt;(V) &amp;&amp; <span class="stringliteral">&quot;PHI Nodes should be excluded!&quot;</span>);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">if</span> (V != <a class="code" href="namespacellvm_1_1SPII.html#a2ab8a310a4181c487902735f4758ca88a36b3dd3b84fde3f8494a9b18af131856">Store</a>)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="X86LowerAMXType_8cpp.html#a20c7ea50a73d61a91772d1c57f2baade">replaceWithTileLoad</a>(U, I8Ptr);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">// Volatile Tile Model:</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">// 1) All the uses of tile data comes from tileload in time.</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">// 2) All the defs of tile data tilestore into mem immediately.</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">// For example:</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">// %t1 = call x86_amx @llvm.x86.tileloadd64.internal(m, k, ...)          key</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment">// %t2 = call x86_amx @llvm.x86.tileloadd64.internal(k, n, ...)</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment">// %t3 = call x86_amx @llvm.x86.tileloadd64.internal(m, n, ...)          amx</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">// %td = tail call x86_amx @llvm.x86.tdpbssd.internal(m, n, k, t1, t2, t3)</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">// call void @llvm.x86.tilestored64.internal(... td)                     area</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">// --------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">// 3) No terminator, call or other amx instructions in the key amx area.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="keywordtype">bool</span> X86VolatileTileData::volatileTileData() {</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordtype">bool</span> Changed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1BasicBlock.html">BasicBlock</a> &amp;<a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a> : <a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 2&gt;</a> PHIInsts;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <a class="code" href="classllvm_1_1SmallVector.html">SmallVector&lt;Instruction *, 8&gt;</a> AMXDefInsts;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> &amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a class="code" href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a>) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()-&gt;isX86_AMXTy())</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;      <span class="keywordflow">if</span> (isa&lt;PHINode&gt;(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        PHIInsts.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        AMXDefInsts.push_back(&amp;<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="comment">// First we &quot;volatile&quot; the non-phi related amx intrinsics.</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : AMXDefInsts) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="X86LowerAMXType_8cpp.html#acf41daf3eeda8514648fe10fbd699be7">isIncomingOfPHI</a>(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      volatileTileNonPHI(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="classllvm_1_1Instruction.html">Instruction</a> *<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a> : PHIInsts) {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      volatileTilePHI(dyn_cast&lt;PHINode&gt;(<a class="code" href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      Changed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keywordflow">return</span> Changed;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;}</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="keyword">namespace </span>{</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160; </div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="keyword">class </span>X86LowerAMXTypeLegacyPass : <span class="keyword">public</span> <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">ID</a>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  X86LowerAMXTypeLegacyPass() : <a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a>(<a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">ID</a>) {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="namespacellvm.html#aa57013f45eb61fd298b1826b78e46d2a">initializeX86LowerAMXTypeLegacyPassPass</a>(*<a class="code" href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a>(<a class="code" href="classllvm_1_1Function.html">Function</a> &amp;<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)<span class="keyword"> override </span>{</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a> *<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a> = &amp;getAnalysis&lt;TargetPassConfig&gt;().getTM&lt;<a class="code" href="classllvm_1_1TargetMachine.html">TargetMachine</a>&gt;();</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    X86LowerAMXType LAT(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = LAT.visit();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">// Prepare for fast register allocation at O0.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// Todo: May better check the volatile model of AMX code, not just</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="comment">// by checking Attribute::OptimizeNone and CodeGenOpt::None.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a>-&gt;getOptLevel() == <a class="code" href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928">CodeGenOpt::None</a>) {</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;      <span class="comment">// If Front End not use O0 but the Mid/Back end use O0, (e.g.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="comment">// &quot;Clang -O2 -S -emit-llvm t.c&quot; + &quot;llc t.ll&quot;) we should make</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      <span class="comment">// sure the amx data is volatile, that is nessary for AMX fast</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;      <span class="comment">// register allocation.</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(Attribute::OptimizeNone)) {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        X86VolatileTileData VTD(<a class="code" href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a> = VTD.volatileTileData() || <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160; </div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="keywordtype">void</span> getAnalysisUsage(<a class="code" href="classllvm_1_1AnalysisUsage.html">AnalysisUsage</a> &amp;AU)<span class="keyword"> const override </span>{</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    AU.<a class="code" href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">addRequired</a>&lt;<a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a>&gt;();</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;};</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;} <span class="comment">// anonymous namespace</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#adb9257105a403ef9d0773b87693f7779">  679</a></span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="X86LowerAMXType_8cpp.html#adb9257105a403ef9d0773b87693f7779">PassName</a>[] = <span class="stringliteral">&quot;Lower AMX type for load/store&quot;</span>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="keywordtype">char</span> <a class="code" href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">X86LowerAMXTypeLegacyPass::ID</a> = 0;</div>
<div class="line"><a name="l00681"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#a2137b1559a07e8633b8c8ee6dcec8fc0">  681</a></span>&#160;<a class="code" href="X86LowerAMXType_8cpp.html#a2137b1559a07e8633b8c8ee6dcec8fc0">INITIALIZE_PASS_BEGIN</a>(X86LowerAMXTypeLegacyPass, <a class="code" href="X86LowerAMXType_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <a class="code" href="X86LowerAMXType_8cpp.html#adb9257105a403ef9d0773b87693f7779">PassName</a>, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                      <span class="keyword">false</span>)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<a class="code" href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a>(<a class="code" href="classllvm_1_1TargetPassConfig.html">TargetPassConfig</a>)</div>
<div class="line"><a name="l00684"></a><span class="lineno"><a class="line" href="X86LowerAMXType_8cpp.html#ae6c865df784842196d411c1466b01686">  684</a></span>&#160;<a class="code" href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a>(X86LowerAMXTypeLegacyPass, <a class="code" href="X86LowerAMXType_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a>, <a class="code" href="X86LowerAMXType_8cpp.html#adb9257105a403ef9d0773b87693f7779">PassName</a>, <a class="code" href="namespacefalse.html">false</a>,</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                    <a class="code" href="namespacefalse.html">false</a>)</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno"><a class="line" href="namespacellvm.html#ad16e92f5dfb41058c8bd8041eab47eb8">  687</a></span>&#160;<a class="code" href="classllvm_1_1FunctionPass.html">FunctionPass</a> *<a class="code" href="namespacellvm.html">llvm</a>::<a class="code" href="namespacellvm.html#ad16e92f5dfb41058c8bd8041eab47eb8">createX86LowerAMXTypePass</a>() {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">new</span> X86LowerAMXTypeLegacyPass();</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;}</div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacellvm_html_ad16e92f5dfb41058c8bd8041eab47eb8"><div class="ttname"><a href="namespacellvm.html#ad16e92f5dfb41058c8bd8041eab47eb8">llvm::createX86LowerAMXTypePass</a></div><div class="ttdeci">FunctionPass * createX86LowerAMXTypePass()</div><div class="ttdoc">The pass transforms load/store &lt;256 x i32&gt; to AMX load/store intrinsics or split the data to two &lt;128...</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00687">X86LowerAMXType.cpp:687</a></div></div>
<div class="ttc" id="aValueTypes_8h_html"><div class="ttname"><a href="ValueTypes_8h.html">ValueTypes.h</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_a2137b1559a07e8633b8c8ee6dcec8fc0"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#a2137b1559a07e8633b8c8ee6dcec8fc0">INITIALIZE_PASS_BEGIN</a></div><div class="ttdeci">INITIALIZE_PASS_BEGIN(X86LowerAMXTypeLegacyPass, DEBUG_TYPE, PassName, false, false) INITIALIZE_PASS_END(X86LowerAMXTypeLegacyPass</div></div>
<div class="ttc" id="anamespacellvm_html"><div class="ttname"><a href="namespacellvm.html">llvm</a></div><div class="ttdoc">--------------------- PointerInfo ------------------------------------</div><div class="ttdef"><b>Definition:</b> <a href="AllocatorList_8h_source.html#l00023">AllocatorList.h:23</a></div></div>
<div class="ttc" id="alib_2Target_2X86_2README_8txt_html_ac88fe1d3a61b056a4f64fbbb156a62ff"><div class="ttname"><a href="lib_2Target_2X86_2README_8txt.html#ac88fe1d3a61b056a4f64fbbb156a62ff">M</a></div><div class="ttdeci">We currently emits eax Perhaps this is what we really should generate is Is imull three or four cycles eax eax The current instruction priority is based on pattern complexity The former is more complex because it folds a load so the latter will not be emitted Perhaps we should use AddedComplexity to give LEA32r a higher priority We should always try to match LEA first since the LEA matching code does some estimate to determine whether the match is profitable if we care more about code then imull is better It s two bytes shorter than movl leal On a Pentium M</div><div class="ttdef"><b>Definition:</b> <a href="lib_2Target_2X86_2README_8txt_source.html#l00252">README.txt:252</a></div></div>
<div class="ttc" id="aclassllvm_1_1DataLayout_html"><div class="ttname"><a href="classllvm_1_1DataLayout.html">llvm::DataLayout</a></div><div class="ttdoc">A parsed version of the target data layout string in and methods for querying it.</div><div class="ttdef"><b>Definition:</b> <a href="DataLayout_8h_source.html#l00112">DataLayout.h:112</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a98c0a84a5dfa8bce341c829709f171e5"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a98c0a84a5dfa8bce341c829709f171e5">llvm::BasicBlock::iterator</a></div><div class="ttdeci">InstListType::iterator iterator</div><div class="ttdoc">Instruction iterators...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00090">BasicBlock.h:90</a></div></div>
<div class="ttc" id="aIntrinsicInst_8h_html"><div class="ttname"><a href="IntrinsicInst_8h.html">IntrinsicInst.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Function_html"><div class="ttname"><a href="classllvm_1_1Function.html">llvm::Function</a></div><div class="ttdef"><b>Definition:</b> <a href="Function_8h_source.html#l00061">Function.h:62</a></div></div>
<div class="ttc" id="aPass_8h_html"><div class="ttname"><a href="Pass_8h.html">Pass.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html_a7ff64b3625b6f9020556ed05a5f72af4"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html#a7ff64b3625b6f9020556ed05a5f72af4">llvm::IntrinsicInst::getIntrinsicID</a></div><div class="ttdeci">Intrinsic::ID getIntrinsicID() const</div><div class="ttdoc">Return the intrinsic ID of this intrinsic.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00052">IntrinsicInst.h:52</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__MB_html_ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781"><div class="ttname"><a href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85a7289f7156c17c31399fe5226bf556781">llvm::ARM_MB::LD</a></div><div class="ttdeci">@ LD</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00072">ARMBaseInfo.h:72</a></div></div>
<div class="ttc" id="aclassllvm_1_1BitCastInst_html"><div class="ttname"><a href="classllvm_1_1BitCastInst.html">llvm::BitCastInst</a></div><div class="ttdoc">This class represents a no-op cast from one type to another.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l05164">Instructions.h:5164</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVector_html"><div class="ttname"><a href="classllvm_1_1SmallVector.html">llvm::SmallVector&lt; Instruction *, 8 &gt;</a></div></div>
<div class="ttc" id="anamespacellvm_1_1LegacyLegalizeActions_html_ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf"><div class="ttname"><a href="namespacellvm_1_1LegacyLegalizeActions.html#ad25716c86372dafbf624b34891685078a031174d0f974cf1041a9cadb84f0dcbf">llvm::LegacyLegalizeActions::Bitcast</a></div><div class="ttdeci">@ Bitcast</div><div class="ttdoc">Perform the operation on a different, but equivalently sized type.</div><div class="ttdef"><b>Definition:</b> <a href="LegacyLegalizerInfo_8h_source.html#l00054">LegacyLegalizerInfo.h:54</a></div></div>
<div class="ttc" id="aclassllvm_1_1IRBuilder_html"><div class="ttname"><a href="classllvm_1_1IRBuilder.html">llvm::IRBuilder&lt;&gt;</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a04219443419738082ae3a5fd4f8e4489"><div class="ttname"><a href="classllvm_1_1Use.html#a04219443419738082ae3a5fd4f8e4489">llvm::Use::get</a></div><div class="ttdeci">Value * get() const</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00067">Use.h:67</a></div></div>
<div class="ttc" id="aOptimizationRemarkEmitter_8h_html"><div class="ttname"><a href="OptimizationRemarkEmitter_8h.html">OptimizationRemarkEmitter.h</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_abef33f2e31a1adf2ae4318a9b14b37fc"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#abef33f2e31a1adf2ae4318a9b14b37fc">createTileStore</a></div><div class="ttdeci">static Instruction * createTileStore(Instruction *TileDef, Value *Ptr)</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00400">X86LowerAMXType.cpp:400</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html"><div class="ttname"><a href="classllvm_1_1Type.html">llvm::Type</a></div><div class="ttdoc">The instances of the Type class are immutable: once they are created, they are never changed.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00045">Type.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a541187eb976df2189b40b3f62ed2cee0"><div class="ttname"><a href="classllvm_1_1Use.html#a541187eb976df2189b40b3f62ed2cee0">llvm::Use::getOperandNo</a></div><div class="ttdeci">unsigned getOperandNo() const</div><div class="ttdoc">Return the operand # of this use in its User.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8cpp_source.html#l00033">Use.cpp:33</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_a20c7ea50a73d61a91772d1c57f2baade"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#a20c7ea50a73d61a91772d1c57f2baade">replaceWithTileLoad</a></div><div class="ttdeci">static void replaceWithTileLoad(Use &amp;U, Value *Ptr, bool IsPHI=false)</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00418">X86LowerAMXType.cpp:418</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_aa1e4852319a4ba1d0d006fd04fa95c9f"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#aa1e4852319a4ba1d0d006fd04fa95c9f">createAllocaInstAtEntry</a></div><div class="ttdeci">static AllocaInst * createAllocaInstAtEntry(IRBuilder&lt;&gt; &amp;Builder, BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00065">X86LowerAMXType.cpp:65</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_a96d73bbd7af15cb1fc38c3f4a3bd82e9"><div class="ttname"><a href="MD5_8cpp.html#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a></div><div class="ttdeci">#define F(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00056">MD5.cpp:56</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_ad78e062f62e0d6e453941fb4ca843e4d"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG_TYPE</a></div><div class="ttdeci">#define DEBUG_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00063">X86LowerAMXType.cpp:63</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html"><div class="ttname"><a href="classllvm_1_1BasicBlock.html">llvm::BasicBlock</a></div><div class="ttdoc">LLVM Basic Block Representation.</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00058">BasicBlock.h:59</a></div></div>
<div class="ttc" id="aclassllvm_1_1ConstantInt_html"><div class="ttname"><a href="classllvm_1_1ConstantInt.html">llvm::ConstantInt</a></div><div class="ttdoc">This is the shared class of boolean and integer constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants_8h_source.html#l00079">Constants.h:79</a></div></div>
<div class="ttc" id="aX86_8h_html"><div class="ttname"><a href="X86_8h.html">X86.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_a08ceb864464bce07aed4387d665f6565"><div class="ttname"><a href="classllvm_1_1Type.html#a08ceb864464bce07aed4387d665f6565">llvm::Type::getX86_AMXTy</a></div><div class="ttdeci">static Type * getX86_AMXTy(LLVMContext &amp;C)</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00198">Type.cpp:198</a></div></div>
<div class="ttc" id="aclassllvm_1_1PassRegistry_html_a05a729900b76c89e808c6c3094921b2f"><div class="ttname"><a href="classllvm_1_1PassRegistry.html#a05a729900b76c89e808c6c3094921b2f">llvm::PassRegistry::getPassRegistry</a></div><div class="ttdeci">static PassRegistry * getPassRegistry()</div><div class="ttdoc">getPassRegistry - Access the global registry object, which is automatically initialized at applicatio...</div><div class="ttdef"><b>Definition:</b> <a href="PassRegistry_8cpp_source.html#l00031">PassRegistry.cpp:31</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_a16c39eb6e60b42a40c399d8d65347bb6"><div class="ttname"><a href="classllvm_1_1PHINode.html#a16c39eb6e60b42a40c399d8d65347bb6">llvm::PHINode::getIncomingValue</a></div><div class="ttdeci">Value * getIncomingValue(unsigned i) const</div><div class="ttdoc">Return incoming value number x.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02693">Instructions.h:2693</a></div></div>
<div class="ttc" id="aBuiltinGCs_8cpp_html_a6742d2e0a668baf1196ec69e158d5f15"><div class="ttname"><a href="BuiltinGCs_8cpp.html#a6742d2e0a668baf1196ec69e158d5f15">E</a></div><div class="ttdeci">static GCRegistry::Add&lt; CoreCLRGC &gt; E(&quot;coreclr&quot;, &quot;CoreCLR-compatible GC&quot;)</div></div>
<div class="ttc" id="aclassllvm_1_1User_html"><div class="ttname"><a href="classllvm_1_1User.html">llvm::User</a></div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00044">User.h:44</a></div></div>
<div class="ttc" id="aREADME__ALTIVEC_8txt_html_a9aacd9146afe44bf656cd664e2a88c8c"><div class="ttname"><a href="README__ALTIVEC_8txt.html#a9aacd9146afe44bf656cd664e2a88c8c">C</a></div><div class="ttdeci">(vector float) vec_cmpeq(*A, *B) C</div><div class="ttdef"><b>Definition:</b> <a href="README__ALTIVEC_8txt_source.html#l00086">README_ALTIVEC.txt:86</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html">llvm::AnalysisUsage</a></div><div class="ttdoc">Represent the analysis usage information of a pass.</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00047">PassAnalysisSupport.h:47</a></div></div>
<div class="ttc" id="allvm_2Target_2TargetMachine_8h_html"><div class="ttname"><a href="llvm_2Target_2TargetMachine_8h.html">TargetMachine.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_aecb93439702247fe5353a9966f7cefcd"><div class="ttname"><a href="classllvm_1_1Value.html#aecb93439702247fe5353a9966f7cefcd">llvm::Value::uses</a></div><div class="ttdeci">iterator_range&lt; use_iterator &gt; uses()</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00377">Value.h:377</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a161fd4e9fa5367f64c2a4c9e921c3ad3"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a161fd4e9fa5367f64c2a4c9e921c3ad3">llvm::BasicBlock::getFirstInsertionPt</a></div><div class="ttdeci">const_iterator getFirstInsertionPt() const</div><div class="ttdoc">Returns an iterator to the first instruction in this block that is suitable for inserting a non-PHI i...</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8cpp_source.html#l00249">BasicBlock.cpp:249</a></div></div>
<div class="ttc" id="anamespacefalse_html"><div class="ttname"><a href="namespacefalse.html">false</a></div><div class="ttdef"><b>Definition:</b> <a href="StackSlotColoring_8cpp_source.html#l00142">StackSlotColoring.cpp:142</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html"><div class="ttname"><a href="classllvm_1_1Instruction.html">llvm::Instruction</a></div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00045">Instruction.h:46</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html_a50a2e57da274f8d69b9f932977379cdf"><div class="ttname"><a href="classllvm_1_1Use.html#a50a2e57da274f8d69b9f932977379cdf">llvm::Use::getUser</a></div><div class="ttdeci">User * getUser() const</div><div class="ttdoc">Returns the User that contains this Use.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00073">Use.h:73</a></div></div>
<div class="ttc" id="aPatternMatch_8h_html"><div class="ttname"><a href="PatternMatch_8h.html">PatternMatch.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html_aef51af4b490af6b3bf2dfbc8737a8f9f"><div class="ttname"><a href="classllvm_1_1PHINode.html#aef51af4b490af6b3bf2dfbc8737a8f9f">llvm::PHINode::getNumIncomingValues</a></div><div class="ttdeci">unsigned getNumIncomingValues() const</div><div class="ttdoc">Return the number of incoming edges.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02689">Instructions.h:2689</a></div></div>
<div class="ttc" id="anamespacellvm_html_a6497a581a4f7152729c29a368ac7d7be"><div class="ttname"><a href="namespacellvm.html#a6497a581a4f7152729c29a368ac7d7be">llvm::None</a></div><div class="ttdeci">const NoneType None</div><div class="ttdef"><b>Definition:</b> <a href="None_8h_source.html#l00023">None.h:23</a></div></div>
<div class="ttc" id="aPassSupport_8h_html_a74ce8276b89067e806f67c45a6d92575"><div class="ttname"><a href="PassSupport_8h.html#a74ce8276b89067e806f67c45a6d92575">INITIALIZE_PASS_END</a></div><div class="ttdeci">#define INITIALIZE_PASS_END(passName, arg, name, cfg, analysis)</div><div class="ttdef"><b>Definition:</b> <a href="PassSupport_8h_source.html#l00058">PassSupport.h:58</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__PROC_html_a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e"><div class="ttname"><a href="namespacellvm_1_1ARM__PROC.html#a1add7850fad3f66c140ecee871460ea4ae9d798593a4a6b5cc48486a453a59e5e">llvm::ARM_PROC::IE</a></div><div class="ttdeci">@ IE</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00027">ARMBaseInfo.h:27</a></div></div>
<div class="ttc" id="aCodeGen_2Passes_8h_html"><div class="ttname"><a href="CodeGen_2Passes_8h.html">Passes.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1TargetPassConfig_html"><div class="ttname"><a href="classllvm_1_1TargetPassConfig.html">llvm::TargetPassConfig</a></div><div class="ttdoc">Target-Independent Code Generator Pass Configuration Options.</div><div class="ttdef"><b>Definition:</b> <a href="TargetPassConfig_8h_source.html#l00084">TargetPassConfig.h:84</a></div></div>
<div class="ttc" id="aclassllvm_1_1StoreInst_html"><div class="ttname"><a href="classllvm_1_1StoreInst.html">llvm::StoreInst</a></div><div class="ttdoc">An instruction for storing to memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00304">Instructions.h:304</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_ae6b978645b8ac72d1a35e1298ffdd4f0"><div class="ttname"><a href="classllvm_1_1Instruction.html#ae6b978645b8ac72d1a35e1298ffdd4f0">llvm::Instruction::eraseFromParent</a></div><div class="ttdeci">SymbolTableList&lt; Instruction &gt;::iterator eraseFromParent()</div><div class="ttdoc">This method unlinks 'this' from the containing basic block and deletes it.</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8cpp_source.html#l00078">Instruction.cpp:78</a></div></div>
<div class="ttc" id="anamespacellvm_1_1ARM__MB_html_ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2"><div class="ttname"><a href="namespacellvm_1_1ARM__MB.html#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">llvm::ARM_MB::ST</a></div><div class="ttdeci">@ ST</div><div class="ttdef"><b>Definition:</b> <a href="MCTargetDesc_2ARMBaseInfo_8h_source.html#l00073">ARMBaseInfo.h:73</a></div></div>
<div class="ttc" id="aSVEIntrinsicOpts_8cpp_html_a2bb87eb1bcbc74783a83ae945eb8fa36"><div class="ttname"><a href="SVEIntrinsicOpts_8cpp.html#a2bb87eb1bcbc74783a83ae945eb8fa36">INITIALIZE_PASS_DEPENDENCY</a></div><div class="ttdeci">INITIALIZE_PASS_DEPENDENCY(DominatorTreeWrapperPass)</div></div>
<div class="ttc" id="aclassllvm_1_1LLVMContext_html"><div class="ttname"><a href="classllvm_1_1LLVMContext.html">llvm::LLVMContext</a></div><div class="ttdoc">This is an important class for using LLVM in a threaded context.</div><div class="ttdef"><b>Definition:</b> <a href="LLVMContext_8h_source.html#l00068">LLVMContext.h:68</a></div></div>
<div class="ttc" id="aMD5_8cpp_html_ac0eafdc9ee161b71e7af98af736952fd"><div class="ttname"><a href="MD5_8cpp.html#ac0eafdc9ee161b71e7af98af736952fd">I</a></div><div class="ttdeci">#define I(x, y, z)</div><div class="ttdef"><b>Definition:</b> <a href="MD5_8cpp_source.html#l00059">MD5.cpp:59</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_a037d32dd369344ad942d161c3c2681a9"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#a037d32dd369344ad942d161c3c2681a9">getAllocaPos</a></div><div class="ttdeci">static Value * getAllocaPos(BasicBlock *BB)</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00384">X86LowerAMXType.cpp:384</a></div></div>
<div class="ttc" id="aTargetPassConfig_8h_html"><div class="ttname"><a href="TargetPassConfig_8h.html">TargetPassConfig.h</a></div><div class="ttdoc">Target-Independent Code Generator Pass Configuration Options pass.</div></div>
<div class="ttc" id="anamespacellvm_html_aa57013f45eb61fd298b1826b78e46d2a"><div class="ttname"><a href="namespacellvm.html#aa57013f45eb61fd298b1826b78e46d2a">llvm::initializeX86LowerAMXTypeLegacyPassPass</a></div><div class="ttdeci">void initializeX86LowerAMXTypeLegacyPassPass(PassRegistry &amp;)</div></div>
<div class="ttc" id="aIRBuilder_8h_html"><div class="ttname"><a href="IRBuilder_8h.html">IRBuilder.h</a></div></div>
<div class="ttc" id="aSILowerControlFlow_8cpp_html_a4868c5d81c5ccc98c47aeab6244346a0"><div class="ttname"><a href="SILowerControlFlow_8cpp.html#a4868c5d81c5ccc98c47aeab6244346a0">assert</a></div><div class="ttdeci">assert(ImpDefSCC.getReg()==AMDGPU::SCC &amp;&amp;ImpDefSCC.isDef())</div></div>
<div class="ttc" id="aclassllvm_1_1TargetMachine_html"><div class="ttname"><a href="classllvm_1_1TargetMachine.html">llvm::TargetMachine</a></div><div class="ttdoc">Primary interface to the complete machine description for the target machine.</div><div class="ttdef"><b>Definition:</b> <a href="llvm_2Target_2TargetMachine_8h_source.html#l00077">TargetMachine.h:77</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_a1f0b9358936e3e00c42a460abbfb2868"><div class="ttname"><a href="classllvm_1_1User.html#a1f0b9358936e3e00c42a460abbfb2868">llvm::User::replaceUsesOfWith</a></div><div class="ttdeci">void replaceUsesOfWith(Value *From, Value *To)</div><div class="ttdoc">Replace uses of one Value with another.</div><div class="ttdef"><b>Definition:</b> <a href="User_8cpp_source.html#l00021">User.cpp:21</a></div></div>
<div class="ttc" id="allvm_2Support_2ErrorHandling_8h_html_ace243f5c25697a1107cce46626b3dc94"><div class="ttname"><a href="llvm_2Support_2ErrorHandling_8h.html#ace243f5c25697a1107cce46626b3dc94">llvm_unreachable</a></div><div class="ttdeci">#define llvm_unreachable(msg)</div><div class="ttdoc">Marks that the current location is not supposed to be reachable.</div><div class="ttdef"><b>Definition:</b> <a href="llvm_2Support_2ErrorHandling_8h_source.html#l00136">ErrorHandling.h:136</a></div></div>
<div class="ttc" id="aclassllvm_1_1Module_html"><div class="ttname"><a href="classllvm_1_1Module.html">llvm::Module</a></div><div class="ttdoc">A Module instance is used to store all the information related to an LLVM module.</div><div class="ttdef"><b>Definition:</b> <a href="Module_8h_source.html#l00067">Module.h:67</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_adb9257105a403ef9d0773b87693f7779"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#adb9257105a403ef9d0773b87693f7779">PassName</a></div><div class="ttdeci">static const char PassName[]</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00679">X86LowerAMXType.cpp:679</a></div></div>
<div class="ttc" id="aAssumeBundleBuilder_8cpp_html_afb136e0532bcaed86521b462e6538d62"><div class="ttname"><a href="AssumeBundleBuilder_8cpp.html#afb136e0532bcaed86521b462e6538d62">Builder</a></div><div class="ttdeci">assume Assume Builder</div><div class="ttdef"><b>Definition:</b> <a href="AssumeBundleBuilder_8cpp_source.html#l00651">AssumeBundleBuilder.cpp:651</a></div></div>
<div class="ttc" id="anamespacellvm_1_1CodeGenOpt_html_a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928"><div class="ttname"><a href="namespacellvm_1_1CodeGenOpt.html#a411055ea15209051c2370bbf655ec8d4a451bbac85aff02d070be3c17a6bef928">llvm::CodeGenOpt::None</a></div><div class="ttdeci">@ None</div><div class="ttdef"><b>Definition:</b> <a href="CodeGen_8h_source.html#l00053">CodeGen.h:53</a></div></div>
<div class="ttc" id="aDataLayout_8h_html"><div class="ttname"><a href="DataLayout_8h.html">DataLayout.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_af11a6ebf7ab3c388234cb6d5378439a3"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#af11a6ebf7ab3c388234cb6d5378439a3">llvm::AnalysisUsage::setPreservesCFG</a></div><div class="ttdeci">void setPreservesCFG()</div><div class="ttdoc">This function should be called by the pass, iff they do not:</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8cpp_source.html#l00253">Pass.cpp:253</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html_a6393a2d4fe7e10b28a0dcc35f881567b"><div class="ttname"><a href="classllvm_1_1Value.html#a6393a2d4fe7e10b28a0dcc35f881567b">llvm::Value::getType</a></div><div class="ttdeci">Type * getType() const</div><div class="ttdoc">All values are typed, get the type of this value.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00256">Value.h:256</a></div></div>
<div class="ttc" id="anamespacellvm_1_1SPII_html_a2ab8a310a4181c487902735f4758ca88a36b3dd3b84fde3f8494a9b18af131856"><div class="ttname"><a href="namespacellvm_1_1SPII.html#a2ab8a310a4181c487902735f4758ca88a36b3dd3b84fde3f8494a9b18af131856">llvm::SPII::Store</a></div><div class="ttdeci">@ Store</div><div class="ttdef"><b>Definition:</b> <a href="SparcInstrInfo_8h_source.html#l00033">SparcInstrInfo.h:33</a></div></div>
<div class="ttc" id="aclassllvm_1_1ilist__node__impl_html_af719fc783be6589465137d997701a432"><div class="ttname"><a href="classllvm_1_1ilist__node__impl.html#af719fc783be6589465137d997701a432">llvm::ilist_node_impl::getIterator</a></div><div class="ttdeci">self_iterator getIterator()</div><div class="ttdef"><b>Definition:</b> <a href="ilist__node_8h_source.html#l00081">ilist_node.h:81</a></div></div>
<div class="ttc" id="aAArch64SLSHardening_8cpp_html_ad467c4ab9119043f9b7750ab986be61a"><div class="ttname"><a href="AArch64SLSHardening_8cpp.html#ad467c4ab9119043f9b7750ab986be61a">DL</a></div><div class="ttdeci">MachineBasicBlock MachineBasicBlock::iterator DebugLoc DL</div><div class="ttdef"><b>Definition:</b> <a href="AArch64SLSHardening_8cpp_source.html#l00076">AArch64SLSHardening.cpp:76</a></div></div>
<div class="ttc" id="aX86LowerAMXType_8cpp_html_acf41daf3eeda8514648fe10fbd699be7"><div class="ttname"><a href="X86LowerAMXType_8cpp.html#acf41daf3eeda8514648fe10fbd699be7">isIncomingOfPHI</a></div><div class="ttdeci">static bool isIncomingOfPHI(Instruction *I)</div><div class="ttdef"><b>Definition:</b> <a href="X86LowerAMXType_8cpp_source.html#l00443">X86LowerAMXType.cpp:443</a></div></div>
<div class="ttc" id="aclassllvm_1_1LoadInst_html"><div class="ttname"><a href="classllvm_1_1LoadInst.html">llvm::LoadInst</a></div><div class="ttdoc">An instruction for reading from memory.</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00175">Instructions.h:175</a></div></div>
<div class="ttc" id="aEntryExitInstrumenter_8cpp_html_a3985f1f39349428d17f0d2b81ebc6349"><div class="ttname"><a href="EntryExitInstrumenter_8cpp.html#a3985f1f39349428d17f0d2b81ebc6349">runOnFunction</a></div><div class="ttdeci">static bool runOnFunction(Function &amp;F, bool PostInlining)</div><div class="ttdef"><b>Definition:</b> <a href="EntryExitInstrumenter_8cpp_source.html#l00069">EntryExitInstrumenter.cpp:69</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1SendMsg_html_a8594419a4ddfad2c9a79279c490e466d"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1SendMsg.html#a8594419a4ddfad2c9a79279c490e466d">llvm::AMDGPU::SendMsg::Op</a></div><div class="ttdeci">Op</div><div class="ttdef"><b>Definition:</b> <a href="SIDefines_8h_source.html#l00314">SIDefines.h:314</a></div></div>
<div class="ttc" id="anamespacellvm_html_aa0953557ed13c0ed48e740653e07c979"><div class="ttname"><a href="namespacellvm.html#aa0953557ed13c0ed48e740653e07c979">llvm::post_order</a></div><div class="ttdeci">iterator_range&lt; po_iterator&lt; T &gt; &gt; post_order(const T &amp;G)</div><div class="ttdef"><b>Definition:</b> <a href="PostOrderIterator_8h_source.html#l00188">PostOrderIterator.h:188</a></div></div>
<div class="ttc" id="aFunction_8h_html"><div class="ttname"><a href="Function_8h.html">Function.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1SmallVectorImpl_html_aac0ea55010b7b1a301e65a0baea057aa"><div class="ttname"><a href="classllvm_1_1SmallVectorImpl.html#aac0ea55010b7b1a301e65a0baea057aa">llvm::SmallVectorImpl::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="SmallVector_8h_source.html#l00585">SmallVector.h:585</a></div></div>
<div class="ttc" id="aclassllvm_1_1IntrinsicInst_html"><div class="ttname"><a href="classllvm_1_1IntrinsicInst.html">llvm::IntrinsicInst</a></div><div class="ttdoc">A wrapper class for inspecting calls to intrinsic functions.</div><div class="ttdef"><b>Definition:</b> <a href="IntrinsicInst_8h_source.html#l00045">IntrinsicInst.h:45</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html_af3bb24b322533dbe8a63c84b18568fe1"><div class="ttname"><a href="classllvm_1_1AllocaInst.html#af3bb24b322533dbe8a63c84b18568fe1">llvm::AllocaInst::setAlignment</a></div><div class="ttdeci">void setAlignment(Align Align)</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00124">Instructions.h:124</a></div></div>
<div class="ttc" id="aclassllvm_1_1BasicBlock_html_a6d3231fb84ed4182ec22e9442a87dbf8"><div class="ttname"><a href="classllvm_1_1BasicBlock.html#a6d3231fb84ed4182ec22e9442a87dbf8">llvm::BasicBlock::reverse_iterator</a></div><div class="ttdeci">InstListType::reverse_iterator reverse_iterator</div><div class="ttdef"><b>Definition:</b> <a href="BasicBlock_8h_source.html#l00092">BasicBlock.h:92</a></div></div>
<div class="ttc" id="aInstructions_8h_html"><div class="ttname"><a href="Instructions_8h.html">Instructions.h</a></div></div>
<div class="ttc" id="aPostOrderIterator_8h_html"><div class="ttname"><a href="PostOrderIterator_8h.html">PostOrderIterator.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1CallBase_html_ab2caa29167597390ab2fc3cf30d70389"><div class="ttname"><a href="classllvm_1_1CallBase.html#ab2caa29167597390ab2fc3cf30d70389">llvm::CallBase::getArgOperand</a></div><div class="ttdeci">Value * getArgOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="InstrTypes_8h_source.html#l01338">InstrTypes.h:1338</a></div></div>
<div class="ttc" id="aclassllvm_1_1Instruction_html_a1a7f07aaef6a3bee130bf0e0f0536802"><div class="ttname"><a href="classllvm_1_1Instruction.html#a1a7f07aaef6a3bee130bf0e0f0536802">llvm::Instruction::getParent</a></div><div class="ttdeci">const BasicBlock * getParent() const</div><div class="ttdef"><b>Definition:</b> <a href="IR_2Instruction_8h_source.html#l00094">Instruction.h:94</a></div></div>
<div class="ttc" id="aTargetTransformInfo_8h_html"><div class="ttname"><a href="TargetTransformInfo_8h.html">TargetTransformInfo.h</a></div><div class="ttdoc">This pass exposes codegen information to IR-level passes.</div></div>
<div class="ttc" id="aclassllvm_1_1PHINode_html"><div class="ttname"><a href="classllvm_1_1PHINode.html">llvm::PHINode</a></div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l02597">Instructions.h:2597</a></div></div>
<div class="ttc" id="aPassBuilderBindings_8cpp_html_ab76052bb166c65901edb603a3e1f03ab"><div class="ttname"><a href="PassBuilderBindings_8cpp.html#ab76052bb166c65901edb603a3e1f03ab">TM</a></div><div class="ttdeci">const char LLVMTargetMachineRef TM</div><div class="ttdef"><b>Definition:</b> <a href="PassBuilderBindings_8cpp_source.html#l00047">PassBuilderBindings.cpp:47</a></div></div>
<div class="ttc" id="aclassllvm_1_1FunctionPass_html"><div class="ttname"><a href="classllvm_1_1FunctionPass.html">llvm::FunctionPass</a></div><div class="ttdoc">FunctionPass class - This class is used to implement most global optimizations.</div><div class="ttdef"><b>Definition:</b> <a href="Pass_8h_source.html#l00298">Pass.h:298</a></div></div>
<div class="ttc" id="alib_2CodeGen_2README_8txt_html_a09776db24cf586ec9f1e18f3bae14099"><div class="ttname"><a href="lib_2CodeGen_2README_8txt.html#a09776db24cf586ec9f1e18f3bae14099">BB</a></div><div class="ttdeci">Common register allocation spilling lr str ldr sxth r3 ldr mla r4 can lr mov lr str ldr sxth r3 mla r4 and then merge mul and lr str ldr sxth r3 mla r4 It also increase the likelihood the store may become dead bb27 Successors according to LLVM BB</div><div class="ttdef"><b>Definition:</b> <a href="lib_2CodeGen_2README_8txt_source.html#l00039">README.txt:39</a></div></div>
<div class="ttc" id="aclassllvm_1_1AnalysisUsage_html_ae5c60fd282ee894c87ea02c3f0fcb6d0"><div class="ttname"><a href="classllvm_1_1AnalysisUsage.html#ae5c60fd282ee894c87ea02c3f0fcb6d0">llvm::AnalysisUsage::addRequired</a></div><div class="ttdeci">AnalysisUsage &amp; addRequired()</div><div class="ttdef"><b>Definition:</b> <a href="PassAnalysisSupport_8h_source.html#l00075">PassAnalysisSupport.h:75</a></div></div>
<div class="ttc" id="anamespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key_html_a1958a762261549463a280bac3274d6d5"><div class="ttname"><a href="namespacellvm_1_1AMDGPU_1_1HSAMD_1_1Kernel_1_1Key.html#a1958a762261549463a280bac3274d6d5">llvm::AMDGPU::HSAMD::Kernel::Key::Args</a></div><div class="ttdeci">constexpr char Args[]</div><div class="ttdoc">Key for Kernel::Metadata::mArgs.</div><div class="ttdef"><b>Definition:</b> <a href="AMDGPUMetadata_8h_source.html#l00389">AMDGPUMetadata.h:389</a></div></div>
<div class="ttc" id="aclassllvm_1_1AllocaInst_html"><div class="ttname"><a href="classllvm_1_1AllocaInst.html">llvm::AllocaInst</a></div><div class="ttdoc">an instruction to allocate memory on the stack</div><div class="ttdef"><b>Definition:</b> <a href="Instructions_8h_source.html#l00062">Instructions.h:62</a></div></div>
<div class="ttc" id="aclassllvm_1_1User_html_abe1de1520a21f77ac57cc210bf0fb0b4"><div class="ttname"><a href="classllvm_1_1User.html#abe1de1520a21f77ac57cc210bf0fb0b4">llvm::User::getOperand</a></div><div class="ttdeci">Value * getOperand(unsigned i) const</div><div class="ttdef"><b>Definition:</b> <a href="User_8h_source.html#l00169">User.h:169</a></div></div>
<div class="ttc" id="aInitializePasses_8h_html"><div class="ttname"><a href="InitializePasses_8h.html">InitializePasses.h</a></div></div>
<div class="ttc" id="aclassllvm_1_1Value_html"><div class="ttname"><a href="classllvm_1_1Value.html">llvm::Value</a></div><div class="ttdoc">LLVM Value Representation.</div><div class="ttdef"><b>Definition:</b> <a href="Value_8h_source.html#l00075">Value.h:75</a></div></div>
<div class="ttc" id="aclassllvm_1_1VectorType_html_a8c90e6c50e795b17466482a04947690e"><div class="ttname"><a href="classllvm_1_1VectorType.html#a8c90e6c50e795b17466482a04947690e">llvm::VectorType::get</a></div><div class="ttdeci">static VectorType * get(Type *ElementType, ElementCount EC)</div><div class="ttdoc">This static method is the primary way to construct an VectorType.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8cpp_source.html#l00634">Type.cpp:634</a></div></div>
<div class="ttc" id="aclassllvm_1_1Type_html_ab549082d9dfb91ec9a8dc06601d54855"><div class="ttname"><a href="classllvm_1_1Type.html#ab549082d9dfb91ec9a8dc06601d54855">llvm::Type::isX86_AMXTy</a></div><div class="ttdeci">bool isX86_AMXTy() const</div><div class="ttdoc">Return true if this is X86 AMX.</div><div class="ttdef"><b>Definition:</b> <a href="Type_8h_source.html#l00186">Type.h:186</a></div></div>
<div class="ttc" id="aclassllvm_1_1Use_html"><div class="ttname"><a href="classllvm_1_1Use.html">llvm::Use</a></div><div class="ttdoc">A Use represents the edge between a Value definition and its users.</div><div class="ttdef"><b>Definition:</b> <a href="Use_8h_source.html#l00044">Use.h:44</a></div></div>
<div class="ttc" id="aSmallSet_8h_html"><div class="ttname"><a href="SmallSet_8h.html">SmallSet.h</a></div></div>
<div class="ttc" id="anamespacellvm_1_1Intrinsic_html_a80add6b3b1cdaec560907995127adc16"><div class="ttname"><a href="namespacellvm_1_1Intrinsic.html#a80add6b3b1cdaec560907995127adc16">llvm::Intrinsic::ID</a></div><div class="ttdeci">unsigned ID</div><div class="ttdef"><b>Definition:</b> <a href="TargetTransformInfo_8h_source.html#l00038">TargetTransformInfo.h:38</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Feb 8 2022 04:53:18 for LLVM by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.20
</small></address>
</body>
</html>
